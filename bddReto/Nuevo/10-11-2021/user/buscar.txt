<?php
session_start();
?>

<html>
<head>
<title>Busqueda</title>
</head>
<body>
<form name="login" method="post" action="">

<h3>
Fecha Inicio :<input type="text" name="fecini" placeholder="aaaa-mm-dd  --:--:--">
</h3>

<h3>
Fecha Fin :<input type="text" name="fecfin" placeholder="aaaa-mm-dd  --:--:--">
</h3>

<h3>
Importe Inicial :<input type="number" name="numero1" placeholder="10$">
</h3>

<h3>
Importe Final :<input type="number" min="0" name="numero2" placeholder="100$">
</h3>


<input type="submit" name="buscar" value="Buscar por Fecha">
<input type="submit" name="buscarImporte" value="Buscar por Importe">

</form>

<?php
if(isset($_POST["buscar"])){  //Nombre del boton del html
   
    $server = 'localhost';
    $username = 'user_wordpress';
    $password = 'pass_wordpress';
    $database = 'wordpress';
?>
    		<table class="default">
 		<tr>
    			<th>Id Proyecto</th>
                        <th>Id Departamento</th>
    			<th>Fecha gasto</th>
    			<th>Distancia total</th>
    			<th>Medio transporte</th>
                	<th>Precio peaje</th>
                        <th>Precio parking</th>
                        <th>Tipo combustible</th>
                        <th>Factura total</th>
                 </tr>

</body>
</html>

<?php
$idd=$_SESSION["id"];
    try {
        $base = new PDO("mysql:host=$server;dbname=$database;", $username, $password);
        $base->setAttribute(PDO::ATTR_ERRMODE, PDO::ERRMODE_EXCEPTION);


        $sql = "SELECT * FROM gastos WHERE intIdUser = $idd and dateFechaHora between :fecinisql and :fecfinsql ";
        $stmt=$base->prepare($sql);
        $stmt->bindValue(":fecinisql", $_POST["fecini"]);
        $stmt->bindValue(":fecfinsql", $_POST["fecfin"]);
        //$stmt->bindValue(":id", $_SESSION["id"]);
            
        $stmt->execute();
        $numero_registro=$stmt->rowCount(); 
        
            foreach ($stmt as $row) {	//extrae los datos de la sql "El select" para crear la sesion abajo
		extract($row);


?>
		 <tr>
			<td><?php echo $intIdProyecto ?></td>
			<td><?php echo $intIdDepartamento ?></td>
                        <td><?php echo $dateFechaHora ?></td>
                        <td><?php echo $doubleDistanciaTotalKm ?></td>
                        <td><?php echo $vchMediotransporte ?></td>
                        <td><?php echo $doublePeaje ?></td>
                        <td><?php echo $doubleParking ?></td>
                        <td><?php echo $vchCombustible ?></td>
                        <td><?php echo $doubleTotalFactura ?></td>
                 <tr>
<?php
}//foreach

?>
</table>

<?php
    } catch (PDOException $e) {
        die('Connection Failed: ' . $e->getMessage());
    } 

 
} //isset


// *************************************  BOTON IMPORTE  ******************************

if(isset($_POST["buscarImporte"])){  //Nombre del boton del html
   
    $server = 'localhost';
    $username = 'user_wordpress';
    $password = 'pass_wordpress';
    $database = 'wordpress';
?>
    		<table class="default">
 		<tr>
    			<th>IdProyecto</th>
                        <th>IdDepartamento</th>
    			<th>Fecha gasto</th>
    			<th>Distancia total</th>
    			<th>Medio transporte</th>
                	<th>Precio peaje</th>
                        <th>Precio parking</th>
                        <th>Tipo combustible</th>
                        <th>Factura total</th>
                 </tr>

</body>
</html>

<?php

$idd=$_SESSION["id"];
$numeroI=$_POST["numero1"];
$numeroF=$_POST["numero2"];

    try {
        $base = new PDO("mysql:host=$server;dbname=$database;", $username, $password);
        $base->setAttribute(PDO::ATTR_ERRMODE, PDO::ERRMODE_EXCEPTION);


        $sql = "SELECT * FROM gastos WHERE intIdUser = $idd and doubleTotalFactura BETWEEN $numeroI AND $numeroF ";
        $stmt=$base->prepare($sql);
        $stmt->bindValue(":fecinisql", $_POST["fecini"]);
        $stmt->bindValue(":fecfinsql", $_POST["fecfin"]);
            
        $stmt->execute();
        $numero_registro=$stmt->rowCount(); 
        
            foreach ($stmt as $row) {	//extrae los datos de la sql "El select" para crear la sesion abajo
		extract($row);


?>
		 <tr>
			<td><?php echo $intIdProyecto ?></td>
			<td><?php echo $intIdDepartamento ?></td>
                        <td><?php echo $dateFechaHora ?></td>
                        <td><?php echo $doubleDistanciaTotalKm ?></td>
                        <td><?php echo $vchMediotransporte ?></td>
                        <td><?php echo $doublePeaje ?></td>
                        <td><?php echo $doubleParking ?></td>
                        <td><?php echo $vchCombustible ?></td>
                        <td><?php echo $doubleTotalFactura ?></td>
                 <tr>
<?php
}//foreach
?>
</table>

<?php
    } catch (PDOException $e) {
        die('Connection Failed: ' . $e->getMessage());
    } 

 
} //isset



?>

<input type="submit" name="buscar" >

</form>

<?php
if(isset($_POST["buscar"])){  //Nombre del boton del html
   
    $server = 'localhost';
    $username = 'user_wordpress';
    $password = 'pass_wordpress';
    $database = 'wordpress';
?>
    		<table class="default">
 		<tr>
    			<th>Id</th>
    			<th>Email</th>
    			<th>Nombre Usuario</th>
    			<th>Rol</th>
                	<th>Ultima Sesi√≥n</th>
                        <th>Estado</th>
                 </tr>
</table>
</body>
</html>

<?php
    try {
        $base = new PDO("mysql:host=$server;dbname=$database;", $username, $password);
        $base->setAttribute(PDO::ATTR_ERRMODE, PDO::ERRMODE_EXCEPTION);


        $sql = "SELECT * FROM gastos WHERE dateFechaHora between :fecinisql and :fecfinsql ";
        $stmt=$base->prepare($sql);
        $stmt->bindValue(":fecinisql", $_POST["fecini"]);
        $stmt->bindValue(":fecfinsql", $_POST["fecfin"]);
        $fec=$_POST["fecfin"];
            


            $stmt->execute();
            
            $numero_registro=$stmt->rowCount(); 
        
            foreach ($stmt as $row) {	//extrae los datos de la sql "El select" para crear la sesion abajo
		extract($row);


?>
		 <tr>
			<td><?php echo "hola"; ?></td>

                 <tr>
<?php

}//foreach

    } catch (PDOException $e) {
        die('Connection Failed: ' . $e->getMessage());
    } 

 
} //isset



?>